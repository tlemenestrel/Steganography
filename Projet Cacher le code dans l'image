# Stéganographie - v0.1
# Ce script est un programme qui dissimule du texte dans une image
# License libre CC
# Colin Laganier - Thomas Lemenestrel - 2017.12.13

from PIL import Image
im = Image.open("/Users/TLM/Desktop/duck.png")
#on récupère les dimensions de l'image
largeur,hauteur=im.size
#On éclate l'image en trois (rouge vert bleu)
r,g,b,t=im.split()
#on transforme l'image en liste
redPix=list(r.getdata())
print(redPix[2:30])

#le message à  coder
Texte="quelque chose de bien" # On importe le texte depuis l'interface TKinter
#on note la longueur de la chaine et on la transforme en binaire
longTxt=len(Texte)
longBin=bin(len(Texte))[2:].rjust(8,"0")
#on transforme la chaine en une liste de 0 et de 1 
ListeBinaire=[bin(ord(x))[2:].rjust(8,"0") for x in Texte]
#transformation de la liste en chaine
ChaineBinaire=''.join(ListeBinaire)
#on code la longueur de la liste dans les 8 premiers pixels rouges
for j in range(8):
    redPix[j]=2*int(redPix[j]//2)+int(longBin[j])

#on code la chaine dans les pixels suivants
for i in range(8*longTxt):
    redPix[i+8]=2*int(redPix[i+8]//2)+int(ChaineBinaire[i])
#on recrée l'image rouge 
ImageRefaite = Image.new("L",(largeur,hauteur))
ImageRefaite.putdata(redPix)
#fusion des trois nouvelles images
ImageFinale = Image.merge('RGBA',(ImageRefaite,g,b,t)) 
ImageFinale.save("Stéganographie.png")
print(redPix[2:30])
